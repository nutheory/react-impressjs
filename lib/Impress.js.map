{"version":3,"sources":["../src/components/Impress.js"],"names":["html","document","documentElement","body","_lastHash","_stepsData","_activeStep","_idHelper","Impress","props","rootData","hint","hintMessage","fallbackMessage","progress","rootStyles","position","top","left","transformOrigin","transition","transformStyle","defaultData","x","y","z","rotateX","rotateY","rotateZ","scale","state","windowScale","config","impressSupported","activeStep","data","cameraStyles","startX","deltaX","init","goto","addEventListener","e","keyCode","end","home","prev","next","window","location","hash","nextPorps","setState","removeEventListener","event","console","log","defaults","width","height","maxScale","minScale","perspective","transitionDuration","classList","dataset","overflow","$set","$merge","step","duration","scrollTo","target","zoomin","delay","id","targetScale","transform","transitionDelay","stepsDataKeys","Object","keys","findIndex","k","length","stepsDataEntries","entries","firstStep","lastStep","touches","clientX","preventDefault","index","React","cloneElement","key","idHelper","initStep","bind","children","steps","Children","map","stepComponent","stepsTotal","count","handleTouchStart","handleTouchMove","handleTouchEnd","className","Component","propTypes","PropTypes","object","bool","oneOfType","string","defaultProps"],"mappings":"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","file":"Impress.js","sourcesContent":["import React, {Component} from 'react';\nimport update             from 'react/lib/update';\nimport PropTypes          from 'prop-types';\nimport {\n  computeWindowScale,\n  css,\n  getElementFromHash,\n  perspective,\n  pfx,\n  rotate,\n  scale,\n  throttle,\n  toNumber,\n  translate,\n}                         from './util';\n\nimport Progress from './Progress';\nimport Hint     from './Hint';\n\nconst html = document.documentElement,\n      body = document.body;\n\nlet _lastHash  = '',\n    _stepsData = {},\n    _activeStep,\n    _idHelper  = 1;\n\nexport default class Impress extends Component {\n  constructor(props) {\n    super(props);\n\n    const {rootData, hint, hintMessage, fallbackMessage, progress} = props;\n    const rootStyles = {\n      position: 'absolute',\n      top: '50%',\n      left: '50%',\n      transformOrigin: 'top left',\n      transition: 'all 0s ease-in-out',\n      transformStyle: 'preserve-3d',\n    };\n    const defaultData = {\n      x: 0, y: 0, z: 0,\n      rotateX: 0, rotateY: 0, rotateZ: 0,\n      scale: 1,\n    };\n\n    // <Impress /> State\n    this.state = {\n      /** Impress Config **/\n      rootStyles,\n      windowScale: null,\n      config: null,\n      impressSupported: false,\n\n      /** Step Status **/\n      activeStep: {\n        data: defaultData,\n      },\n\n      /** Camera Status **/\n      cameraStyles: rootStyles,\n\n      /** Public attributes provide to use **/\n      rootData: rootData, // (not recommended)\n      hint: hint,\n      hintMessage: hintMessage,\n      fallbackMessage: fallbackMessage,\n      progress: progress,\n\n      /** For touch event **/\n      startX: 0,\n      deltaX: 0,\n    };\n  }\n\n  componentWillMount() {\n    // Init impress\n    this.init();\n  }\n\n  componentDidMount() {\n    const {impressSupported} = this.state;\n\n    // 2017/2/28 暫時想不到好方法\n    if (impressSupported)\n      this.goto(_activeStep, 500);\n\n    // Listener for keyboard event\n    document.addEventListener('keyup', throttle((e) => {\n      if (e.keyCode === 9 ||\n          (e.keyCode >= 32 && e.keyCode <= 40)) {\n        switch (e.keyCode) {\n          case 35: // End\n            this.end();\n            break;\n          case 36: // Home\n            this.home();\n            break;\n          case 33: // Page up\n          case 37: // Left\n          case 38: // Up\n            this.prev();\n            break;\n          case 9:  // Tab\n          case 32: // Space\n          case 34: // Page down\n          case 39: // Right\n          case 40: // Down\n            this.next();\n            break;\n          default:\n            break;\n        }\n      }\n    }, 250), false);\n\n    // Window resize\n    window.addEventListener('resize', throttle(() => {\n      if (impressSupported)\n        this.goto(this.state.activeStep, 500);\n    }, 250), false);\n\n    // URL hash change\n    window.addEventListener('hashchange', throttle(() => {\n      if (window.location.hash !== _lastHash)\n        this.goto(getElementFromHash(_stepsData), 500);\n    }, 250), false);\n  }\n\n  componentWillReceiveProps(nextPorps) {\n    this.setState({\n      fallbackMessage: nextPorps.fallbackMessage,\n      hint: nextPorps.hint,\n      hintMessage: nextPorps.hintMessage,\n    });\n  }\n\n  componentWillUnmount() {\n    document.removeEventListener('keydown', function(event) {\n      console.log(event.keyCode);\n    }, false);\n  }\n\n  /**\n   * Initialize Impress.\n   */\n  init() {\n    const {rootData} = this.state;\n\n    const defaults = {\n      width: 1024,\n      height: 768,\n      maxScale: 1,\n      minScale: 0,\n      perspective: 1000,\n      transitionDuration: 1000,\n    };\n\n    // const ua = navigator.userAgent.toLowerCase()\n\n    // Check impress support or not.\n    const impressSupported =\n        // Browser should support CSS 3D transtorms\n        (pfx('perspective') !== null) &&\n        // Browser should support `classList` and `dataset` APIs\n        (body.classList) &&\n        (body.dataset);// &&\n    // But some mobile devices need to be blacklisted,\n    // because their CSS 3D support or hardware is not\n    // good enough to run impress.js properly, sorry...\n    //( ua.search( /(iphone)|(ipod)|(android)/ ) === -1 );\n\n    // Config\n    const config = {\n      width: toNumber(rootData.width, defaults.width),\n      height: toNumber(rootData.height, defaults.height),\n      maxScale: toNumber(rootData.maxScale, defaults.maxScale),\n      minScale: toNumber(rootData.minScale, defaults.minScale),\n      perspective: toNumber(rootData.perspective, defaults.perspective),\n      transitionDuration: toNumber(\n          rootData.transitionDuration, defaults.transitionDuration,\n      ),\n    };\n    // Window Scale\n    const windowScale = computeWindowScale(config);\n    // HTML height\n    css(html, {\n      height: '100vh',\n      overflow: 'hidden',\n    });\n    // Body style\n    css(body, {\n      height: '100vh',\n      overflow: 'hidden',\n\n      // mobile devise supported\n      position: 'relative',\n    });\n\n    this.setState(update(this.state, {\n      windowScale: {\n        $set: windowScale,\n      },\n      config: {\n        $set: config,\n      },\n      impressSupported: {\n        $set: impressSupported,\n      },\n      rootStyles: {\n        $merge: {\n          'transform': perspective(config.perspective / windowScale) +\n          scale(windowScale),\n        },\n      },\n    }));\n  }\n\n  /**\n   * Initialize Steps.\n   *\n   * @param {Step} step init every Steps in Impress.\n   */\n  static initStep(step) {\n    // Set first Step as enter Step.\n    if (!_activeStep)\n      _activeStep = step;\n\n    _stepsData = update(_stepsData, {\n      $merge: {\n        [step.id]: {\n          id: step.id,\n          className: step.className,\n          data: step.data,\n          duration: step.duration,\n        },\n      },\n    });\n  }\n\n  /**\n   * Navigate to the SPECIFY Step.\n   *\n   * @param {Step} step you want to navigate to.\n   * @param {number} duration 1000 speed of navigation.\n   */\n  goto(step, duration = 1000) {\n    const {config, activeStep} = this.state;\n    let {windowScale} = this.state;\n\n    window.scrollTo(0, 0);\n\n    let target = {\n      x: -step.data.x,\n      y: -step.data.y,\n      z: -step.data.z,\n      rotateX: -step.data.rotateX,\n      rotateY: -step.data.rotateY,\n      rotateZ: -step.data.rotateZ,\n      scale: 1 / step.data.scale,\n    };\n\n    // Check scale for zoom-in\n    let zoomin = target.scale >= (1 / activeStep.data.scale);\n\n    duration = toNumber(duration, config.transitionDuration);\n    let delay = (duration / 2);\n\n    if (step.id === activeStep.id)\n      windowScale = computeWindowScale(config);\n\n    const targetScale = target.scale * windowScale;\n\n    this.setState(update(this.state, {\n      activeStep: {\n        $set: step,\n      },\n      rootStyles: {\n        transform: {\n          $set: perspective(config.perspective / targetScale) +\n          scale(targetScale),\n        },\n        transitionDuration: {\n          $set: duration + 'ms',\n        },\n        transitionDelay: {\n          $set: (zoomin ? delay : 0) + 'ms',\n        },\n      },\n      cameraStyles: {\n        transform: {\n          $set: rotate(target, true) + translate(target),\n        },\n        transitionDuration: {\n          $set: duration + 'ms',\n        },\n        transitionDelay: {\n          $set: (zoomin ? 0 : delay) + 'ms',\n        },\n      },\n    }));\n\n    window.location.hash = _lastHash = '#/' + step.id;\n  }\n\n  // Navigate to the PREVIOUS Step.\n  prev() {\n    const {activeStep} = this.state;\n\n    /**\n     * 2017.04.10\n     * Why we don't use Object.entries() or Object.values() any more ?\n     * Cause the browser of iOS device (Chrome, Safari...) and some of Android devise\n     * DOES'NT supported Object.entries() and Object.values() now...\n     */\n          // const stepsDataEntries = Object.entries( _stepsData );\n          // let prev = stepsDataEntries.findIndex( ([k, v]) => { return k === activeStep.id } ) - 1;\n          // prev = prev >= 0 ? stepsDataEntries[ prev ][1] : stepsDataEntries[ stepsDataEntries.length - 1 ][1];\n\n    const stepsDataKeys = Object.keys(_stepsData);\n    // get index of previous\n    let prev = stepsDataKeys.findIndex(k => k === activeStep.id) - 1;\n\n    // get id via index from stepsData\n    prev = prev >= 0\n        ? stepsDataKeys[prev]\n        : stepsDataKeys[stepsDataKeys.length - 1];\n\n    // get previous step\n    prev = _stepsData[prev];\n\n    this.goto(prev, prev.duration);\n  }\n\n  // Navigate to the NEXT Step.\n  next() {\n    const {activeStep} = this.state;\n    const stepsDataKeys = Object.keys(_stepsData);\n    let next = stepsDataKeys.findIndex(k => k === activeStep.id) + 1;\n    next = next < stepsDataKeys.length ? stepsDataKeys[next] : stepsDataKeys[0];\n    next = _stepsData[next];\n\n    this.goto(next, next.duration);\n  }\n\n  // Navigate to the FIRST Step.\n  home() {\n    const stepsDataEntries = Object.entries(_stepsData);\n    const firstStep = stepsDataEntries[0][1];\n\n    this.goto(firstStep, firstStep.duration);\n  }\n\n  // Navigate to the LAST Step.\n  end() {\n    const stepsDataEntries = Object.entries(_stepsData);\n    const lastStep = stepsDataEntries[stepsDataEntries.length - 1][1];\n\n    this.goto(lastStep, lastStep.duration);\n  }\n\n  // Touch Start( record start position: startX )\n  handleTouchStart(e) {\n    this.setState({\n      startX: e.touches[0].clientX,\n    });\n  }\n\n  // Touch Move( Calculate touch move path: deltaX )\n  handleTouchMove(e) {\n    e.preventDefault();\n    this.setState({\n      deltaX: this.state.startX - e.touches[0].clientX,\n    });\n  }\n\n  // Touch End( decide navigate previous or next Step via 'deltaX' )\n  handleTouchEnd(e) {\n    if (this.state.deltaX > 0) // slide left\n      this.next();\n    else if (this.state.deltaX < 0) // slide right\n      this.prev();\n\n    // reset\n    this.setState({\n      deltaX: 0,\n    });\n  }\n\n  /**\n   * Create <Step />\n   *\n   * @return {Step} to render children.\n   */\n  stepComponent(step, index) {\n    const {activeStep} = this.state;\n\n    return React.cloneElement(step, {\n      key: index,\n      idHelper: step.props.id ? '' : _idHelper++,\n      activeStep: activeStep,\n      initStep: Impress.initStep.bind(this),\n      goto: this.goto.bind(this),\n    }, step.props.children);\n  }\n\n  render() {\n    const {\n            impressSupported,\n            rootStyles, cameraStyles, activeStep,\n            hint, hintMessage,\n            fallbackMessage,\n            progress,\n          } = this.state;\n    const steps = React.Children.map(this.props.children,\n        this.stepComponent.bind(this));\n    const stepsTotal = React.Children.count(this.props.children);\n\n    return (\n        <div id=\"react-impressjs\"\n             className={\n               (impressSupported\n                   ? 'impress-supported'\n                   : 'impress-not-supported') +\n               (activeStep ? ' impress-on-' + activeStep.id : '') +\n               ' impress-enabled'\n             }\n             onTouchStart={this.handleTouchStart.bind(this)}\n             onTouchMove={this.handleTouchMove.bind(this)}\n             onTouchEnd={this.handleTouchEnd.bind(this)}>\n\n          <div id=\"impress\" style={rootStyles}>\n            <div style={cameraStyles}>\n              {\n                impressSupported ? steps :\n                    <div className=\"fallback-message\">{fallbackMessage}</div>\n              }\n            </div>\n          </div>\n          <Hint\n              hint={hint}\n              stepsData={_stepsData}\n              activeStep={activeStep}\n              hintMessage={hintMessage}/>\n          <Progress\n              progress={progress}\n              stepsData={_stepsData}\n              activeStep={activeStep}\n              stepsTotal={stepsTotal}/>\n        </div>\n    );\n  }\n}\n\nImpress.propTypes = {\n  /**\n   * Impress basic config\n   */\n  rootData: PropTypes.object,\n\n  /**\n   * Whether to display hint or not\n   */\n  hint: PropTypes.bool,\n\n  /**\n   * Hint for presentation\n   */\n  hintMessage: PropTypes.oneOfType([PropTypes.object, PropTypes.string]),\n\n  /**\n   * Fallback message is only visible when there is impress-not-supported\n   */\n  fallbackMessage: PropTypes.oneOfType([PropTypes.object, PropTypes.string]),\n\n  /**\n   * Progress of presentation\n   */\n  progress: PropTypes.bool,\n};\n\nImpress.defaultProps = {\n  rootData: {},\n  hint: true,\n  hintMessage: <p>Use <b>Spacebar</b> or <b>Arrow keys</b> to navigate</p>,\n  fallbackMessage: <p>Your browser <b>doesn't support the features\n    required</b> by React-impressJS, so you are presented\n    with a simplified version of this presentation.</p>,\n  progress: false,\n};\n"]}